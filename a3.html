<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, maximum-scale=1.0" />

    <title>Logan's HCDE 439 Physical Computing Page!</title>

    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Logan's Assignment 3!</h1>
    <div class="header">
      <p>Here is all the documentation for assignment 3!</p>
    </div>
    <section class="gallery">
      <figure>
        <img src="inputsetup.jpg" alt="Setup photo" />
        <figcaption>Setup of arduino board</figcaption>
      </figure>
      <figure>
        <img src="a3_schematic.jpg" alt="Schematic" />
        <figcaption>Schematic & calculation of proper resistance</figcaption>
      </figure>
      <figure>
        <img src="GifA3.gif" alt="Demo animation" />
        <figcaption>Gif of temperature sensor working</figcaption>
      </figure>
    </section>
    <section class="code-used">
      <h2>Code used</h2>
      <pre><code>
#include <math.h> // used to compute average temperature per second

int const tempPin = A0;    // Pin for thermistor 
int const redLed = 11;     // Pin for the "Hot" LED
int const greenLed = 10;   // Pin for the "Room Temp" LED
int const blueLed = 9;     // Pin for the "Cold" LED

int const numSamples = 10; // Number of times to take temperature screenshot for average calc

int const R_NOMINAL = 10000;    // Resistance at nominal temperature (10k ohms)
int const B_COEFFICIENT = 3950; // Beta coefficient of the thermistor
float const TEMP_NOMINAL = 25.0; // expected Room temperature

float const hotThreshold = 50.0;    // Anything at or above this is "Hot"
float const coldThreshold = 20.0;   // Anything at or below this is "Cold"


void setup() {
  // Set LED pins as outputs
  pinMode(redLed, OUTPUT);
  pinMode(greenLed, OUTPUT);
  pinMode(blueLed, OUTPUT);
}

void loop() {
  long totalAdc = 0; // Store total Temperatures (before avg is calcuated)
  for (int i = 0; i < numSamples; i++) {
    // Start avg calc
    totalAdc += analogRead(tempPin);
    // Take total temp
    delay(5); 
    // delay next sample by 5 ms
  }

void loop() {
  long totalAdc = 0; // Store total of readings
  
  for (int i = 0; i < numSamples; i++) {
    // Start averaging loop
    int currentReading = analogRead(tempPin); // read pin temperature
    long mappedReading = map(currentReading, 0, 1023, 0, 1023);  // maps the pin temperature
        totalAdc += mappedReading;
    delay(5); // delay next sample by 5 ms
  }

  float avgAdc = (float)totalAdc / numSamples; // calcuates average temp in 1 second interval


  float resistance = R_NOMINAL * (avgAdc / (1023.0 - avgAdc)); //   Calculates the thermistor's current resistance using the average

  // *AI Wrote this section*
  float steinhart;  // Calculate temperature using the B-parameter equation (Steinhart-Hart)
  steinhart = resistance / R_NOMINAL;     // (R / R0)
  steinhart = log(steinhart);             // ln(R / R0)
  steinhart /= B_COEFFICIENT;             // 1/B * ln(R / R0)
  steinhart += 1.0 / (TEMP_NOMINAL + 273.15); // + (1 / T0) in Kelvin
  steinhart = 1.0 / steinhart;            // Invert to get temperature in Kelvin
  float temperatureC = steinhart - 273.15; // Convert to Celsius
  // *End of section*

  // 4. Check the temperature and light the correct LED
  if (temperatureC >= hotThreshold) {
    // if hot, turn on red LED.
    digitalWrite(redLed, HIGH);
    digitalWrite(greenLed, LOW);
    digitalWrite(blueLed, LOW);
  }
  else if (temperatureC <= coldThreshold) {
    // if cold, turn on blue LED
    digitalWrite(redLed, LOW);
    digitalWrite(greenLed, LOW);
    digitalWrite(blueLed, HIGH);
  }
  else {
    // otherwise, keep green LED on
    digitalWrite(redLed, LOW);
    digitalWrite(greenLed, HIGH);
    digitalWrite(blueLed, LOW);
  }

  delay(250); // needed delay to prevent flickering
}
      </code></pre>
    </section>
    <section class="answers">
      <h2>Answer to questions</h2>
      <ol>
        <li>
          <strong>Question 1</strong>
            <p>: Yes, it can be either R1 or R2 in the voltage divider circuit. But if you change it from R1 or R2 to R2 or R1, you will have to change how you write the equation. If R1: V<sub>out</sub> = 5V × (10kΩ / (10kΩ + 20kΩ)) = 5V × (1/3) ≈ 1.67V. If R2: V<sub>out</sub> = 5V × (20kΩ / (10kΩ + 20kΩ)) = 5V × (2/3) ≈ 3.33V</p>
        </li>
        <li>
          <strong>Question 2</strong>
            <img src="inputgraph.jpg" alt="Schematic" />
            <figcaption>graph of voltage of voltage divider for GIF</figcaption>
            <p>Calculations:</p>
            <p>Room Temperature: V = 5 V × (10,000 Ω / (15,000 Ω + 10,000 Ω)) = 5 V × 0.4 = 2.00 V</p>
            <p>Hot: V = 5 V × (3,588 Ω / (10,000 Ω + 3,588 Ω)) ≈ 5 V × 0.264 ≈ 1.32 V</p>
            <p>Cold: V = 5 V × (12,530 Ω / (10,000 Ω + 12,530 Ω)) ≈ 5 V × 0.5 ≈ 2.70 V</p>
        </li>
        <li>
          <strong>Question 3</strong>
          <p>This would make the temperature readings more precise, but it would require changing the numbers in the map function. Instead of using 1023 because there are 1024 options with 10-bit code (210), the input number would have to be 65535 because there are more possibilities (216). In particular, it would look like map(value, 0, 65535, 0, 1023) to account for input values between 0 and 216, and output values between 0 and 210.</p>
        <li>
          <strong>AI mark</strong>
          <p>I used Ai to ask questions and fix some of the issues in my work. I also used AI to write part of the code(it is marked), and I also used it to help add the average temperature reading, which was needed since the temperature reading kept flickering without it, the avg made it more consisent.</p>
        </li>
      </ol>
    </section>
  </body>
</html>
