<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, maximum-scale=1.0" />

    <title>Logan's HCDE 439 Physical Computing Page!</title>

    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Logan's Assignment 4!</h1>
    <div class="header">
      <p>Here is all the documentation for assignment 4!</p>
    </div>
    <section class="gallery">
      <figure>
        <img src="setup_4.jpg" alt="Setup photo" />
        <figcaption>Setup of arduino board</figcaption>
      </figure>
      <figure>
        <img src="schematic_4.jpg" alt="Schematic" style="max-width: 400px; height: auto; display: block;" />
        <figcaption>Schematic </figcaption>
      </figure>
      <figure>
        <video controls style="max-width: 100%; height: auto;">
          <source src="libary_video.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
        <figcaption>video of temperature sensor and display in action</figcaption>
      </figure>
    </section>
    <section class="code-used">
      <h2>Code used</h2>
      <pre><code>

#include <LiquidCrystal.h>     // For the Display
#include <SimpleKalmanFilter.h> // To make temperature outputs more consistent

// DEFINE CONSTANTS & PINS

#define THERMISTOR_PIN A0  // Analog pin for the thermosister
#define LED_PIN 3          // Red LED pin 3

// Set temperature to make the LED turn on
const float TEMP_THRESHOLD = 30.0;

#define FIXED_RESISTOR 10000
#define NOMINAL_RESISTANCE 100000
#define NOMINAL_TEMP 25.0
#define B_COEFFICIENT 3950

// make temperature readings more consisent and smooth
SimpleKalmanFilter tempFilter(2, 2, 0.01);


// Character [0]: Degree Symbol (Â°)
byte degree[8] = {
  B00110,
  B01001,
  B01001,
  B00110,
  B00000,
  B00000,
  B00000,
  B00000
};

// Character [1]: Warning Icon (!)
byte warning[8] = {
  B00000,
  B00100,
  B00100,
  B00100,
  B00100,
  B00000,
  B00100,
  B00000
};


// Initialize the LiquidCrystal library 
LiquidCrystal lcd(7, 8, 9, 10, 11, 12);

float celsius_filtered = 0.0;   // stores smoothed C Temperature
float fahrenheit_filtered = 0.0; // stores smoothed F Temperature


// SETUP FUNCTION
void setup() {
  // Initialize the LCD (16 columns, 2 rows)
  lcd.begin(16, 2);

  // Create the custom characters and assign them to memory locations
  lcd.createChar(0, degree); // degree symbol
  lcd.createChar(1, warning);  // ! symbol

  pinMode(LED_PIN, OUTPUT); 
  digitalWrite(LED_PIN, LOW); // Start with LED off

  lcd.print("Temp. Monitor");  // print startup message
  lcd.setCursor(0, 1);  // go to second line
  lcd.print("Initializing..."); // print startup message
  delay(2000);  // keeps message long enough to read
}


// LOOP FUNCTION 
void loop() {

  // --- Temperature Reading ---
 
  // Read the raw analog value (0-1023)
  int adc_val = analogRead(THERMISTOR_PIN);

  // Convert the voltage reading into a resistance value
  float resistance = FIXED_RESISTOR * (1023.0 / (float)adc_val - 1.0);

  // Convert resistance to temperature (in Celsius)
  float steinhart;
  steinhart = resistance / NOMINAL_RESISTANCE;     // (R/R0)
  steinhart = log(steinhart);                      // ln(R/R0)
  steinhart /= B_COEFFICIENT;                      // 1/B * ln(R/R0)
  steinhart += 1.0 / (NOMINAL_TEMP + 273.15);      // + 1/T0
  steinhart = 1.0 / steinhart;                     // Invert to get T (in Kelvin)
  float celsius_raw = steinhart - 273.15;          // Convert Kelvin to Celsius

  // get a smoothed value
  celsius_filtered = tempFilter.updateEstimate(celsius_raw);

  // Convert filtered Celsius to Fahrenheit for display
  fahrenheit_filtered = (celsius_filtered * 9.0 / 5.0) + 32.0;


  // --- Display & Alert Logic ---
  lcd.clear(); // Clear the screen for every new update
 
  if (celsius_filtered > TEMP_THRESHOLD) {
    // --- ALERT STATE ---
    digitalWrite(LED_PIN, HIGH); // Turn LED ON
   
    // Display a clear warning message
    lcd.setCursor(0, 0); // Start on first line
    lcd.write((uint8_t)1); // print !
    lcd.print(" HIGH TEMP "); // print message
    lcd.write((uint8_t)1);  // print !
   
    lcd.setCursor(0, 1); // start on second line
    lcd.print("Temp: "); // print Temp:
    lcd.print(celsius_filtered, 1); // Print the temperature
    lcd.write((uint8_t)0); // print the Degree symbol
    lcd.print("C"); // Print C
   
  } else {
    // --- NORMAL STATE ---
    digitalWrite(LED_PIN, LOW);  // Turn LED OFF
   
    // Line 1: Display Celsius
    lcd.setCursor(0, 0); // start on first line
    lcd.print("C: "); // print C:
    lcd.print(celsius_filtered, 1); // Print with 1 decimal place
    lcd.write((uint8_t)0); // print Degree symbol
   
    // Line 2: Display Fahrenheit
    lcd.setCursor(0, 1); // start on second line
    lcd.print("F: "); // print F:
    lcd.print(fahrenheit_filtered, 1); // print 1 decimal place
    lcd.write((uint8_t)0); // print Degree symbol
  }

  // Delay for a short time to read display
  delay(500);
}
      </code></pre>
    </section>
    <section class="answers">
      <h2>Answer to questions</h2>
      <ol>
        <li>
          <strong>Question 1</strong>
            <img src="question1_4.jpg" alt="question 1 graph" />
            <figcaption>question 1 graph, it would slowly increase consistentantly until 20 seconds later when it would drop down and increase again </figcaption>
        <li>
          <strong>Question 2</strong>
              <p>Throwout any readings that are unexpected.
                previous = Previous temperature reading
                current = Current temperature reading
                next = Next temperature reading
                if current > previous and current < next:
                  current is valid
                elif current < previous and current > next:
                  current is valid
                else:
                  current is invalid, do not display. 
              </p>
        </li>
        <li>
          <strong>Question 3</strong>
          <p>Do what I did in this code, which is to take an average reading and report out the average reading.
            reading 1 = first temperature reading
            reading 2 = second temperature reading
            reading 3 = third temperature reading

            average = (reading 1 + reading 2 + reading 3) / 3
            print (average)
            </p>
        </li>
        <li>
          <strong>AI mark</strong>
          <p>I tried to use AI to help teach me what I need to do for the physical part of the project, but it was unhelpful. I used various youtube tutorials and combined the knowledge instead. AI was helpful for the coding part and I used it to help write my code. (and fix errors in it)</p>
        </li>
      </ol>
    </section>
  </body>
</html>
